<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ã‚ªãƒ¼ãƒŠãƒ¼ | æ³¨æ–‡ç®¡ç†</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg1:#1a2a6c; --bg2:#b21f1f; --bg3:#fdbb2d;
      --card-bg: rgba(255,255,255,.08);
      --border: rgba(255,255,255,.18);
      --text:#fff; --accent:#fff;
      --shadow: 0 12px 32px rgba(0,0,0,.28);
      --ok:#22c55e; --warn:#f59e0b; --err:#ef4444;
    }
    @media (prefers-color-scheme: light){
      :root{
        --card-bg: rgba(255,255,255,.74);
        --border: rgba(0,0,0,.08);
        --text:#111827; --accent:#111827;
      }
    }
    *{ box-sizing:border-box }
    html,body{
      height:100%; margin:0; color:var(--text);
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Poppins", "Noto Sans JP", sans-serif;
      background: linear-gradient(135deg, var(--bg1), var(--bg2) 55%, var(--bg3));
      background-attachment: fixed;
    }
    .wrap{ min-height:100%; display:grid; place-items:center; padding:32px; }
    .card{
      width:min(1100px, 94vw);
      background: var(--card-bg);
      border:1px solid var(--border);
      border-radius:24px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px);
      padding: clamp(20px, 4vw, 36px);
      animation: pop .5s ease both;
    }
    @keyframes pop{ from{opacity:0; transform:translateY(8px) scale(.985)} to{opacity:1; transform:none} }
    .title{ font-weight:700; font-size:clamp(22px,2.6vw,30px); margin:0 0 8px }
    .sub{ opacity:.9; margin:0 0 16px; font-size:clamp(13px,1.6vw,15px) }

    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap }
    .col{ display:flex; flex-direction:column; gap:8px }
    .input, .btn, select{
      font:600 14px/1.2 system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans JP",sans-serif;
      border-radius:12px; padding:12px 14px;
      border:1px solid var(--border); background: rgba(255,255,255,.1);
      color:inherit;
    }
    .btn{ cursor:pointer; user-select:none; white-space:nowrap; }
    .btn.primary{ background: rgba(34,197,94,.18); border-color: rgba(34,197,94,.35); }
    .btn.warn{ background: rgba(245,158,11,.16); border-color: rgba(245,158,11,.35); }
    .btn.neutral{ background: rgba(255,255,255,.12); }
    .btn:hover{ filter:brightness(1.04) } .btn:active{ transform: translateY(1px) }

    .help{ font-size:12px; opacity:.85; margin-top:8px }
    .msg{ margin-top:10px; font-size:13px; }
    .msg.ok{ color: var(--ok) } .msg.err{ color: var(--err) } .msg.warn{ color: var(--warn) }

    .grid{ display:grid; gap:14px; grid-template-columns: 1.1fr 1fr; margin-top:16px; }
    @media (max-width:980px){ .grid{ grid-template-columns: 1fr } }

    .panel{ padding:14px; border:1px solid var(--border); border-radius:16px; background: rgba(0,0,0,.12); }
    .panel h3{ margin:0 0 10px; font-size:16px }
    .muted{ opacity:.8 }

    .list{ margin-top:10px; border:1px solid var(--border); border-radius:14px; overflow:hidden }
    /* ç¨®é¡åˆ—ã‚’å‰Šé™¤ã—ãŸã®ã§ã‚«ãƒ©ãƒ å†å®šç¾©ï¼ˆãƒãƒ¼ãƒ  / ID / ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ / ä½œæˆ / æ“ä½œï¼‰ */
.thead, .trow{
  display:grid; grid-template-columns: 90px 1fr 200px 140px;
  gap:8px; align-items:center; padding:10px 12px;
}
    .thead{ background: rgba(255,255,255,.08); font-weight:800 }
    .trow{ border-top:1px solid var(--border) }
    .actions{ display:flex; gap:8px; flex-wrap:wrap; }
    .hidden{ display:none !important; }
  </style>
</head>
<body>
  <main class="wrap">

    <!-- ãƒ­ã‚°ã‚¤ãƒ³ -->
    <section id="loginCard" class="card" aria-labelledby="loginTitle">
      <h1 id="loginTitle" class="title">ã‚ªãƒ¼ãƒŠãƒ¼ãƒ­ã‚°ã‚¤ãƒ³</h1>
      <p class="sub">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
      <div class="row" style="margin-top:6px;">
        <input id="pw" class="input" type="password" placeholder="ã‚ªãƒ¼ãƒŠãƒ¼ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
        <button id="togglePw" class="btn neutral" aria-pressed="false" title="è¡¨ç¤º/éè¡¨ç¤º">ğŸ‘</button>
        <button id="loginBtn" class="btn primary">ãƒ­ã‚°ã‚¤ãƒ³</button>
      </div>
      <div id="loginMsg" class="msg" role="status" aria-live="polite"></div>
      <!-- è¦æœ›ã«ã‚ˆã‚Šèª¬æ˜æ–‡ã‚’å‰Šé™¤ -->
    </section>

    <!-- æ³¨æ–‡ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
    <section id="dashCard" class="card hidden" aria-labelledby="dashTitle">
      <h1 id="dashTitle" class="title">æ³¨æ–‡ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h1>
      <p class="sub">æ–™ç†ã‚’é¸ã¶ã¨ã€å…¨ãƒãƒ¼ãƒ ï¼ˆ1ã€œ4ï¼‰ã¸åŒã˜æ³¨æ–‡ã‚’ä¸€æ‹¬ã§å‡ºã—ã¾ã™ã€‚</p>

      <div class="grid">
        <!-- å·¦ï¼šæ³¨æ–‡ä½œæˆï¼ˆæ–™ç†é¸æŠã®ã¿ï¼‰ -->
        <div class="panel">
          <h3>æ³¨æ–‡ã‚’ä½œæˆï¼ˆå…¨ãƒãƒ¼ãƒ ã¸ï¼‰</h3>
          <div class="col">
            <label for="dishSelect">æ–™ç†ã‚’é¸æŠ</label>
            <select id="dishSelect" class="input"></select>
            <div id="dishPreview" class="muted"></div>
                <div class="row" style="margin-top:8px;">
      <button id="randomDishBtn" class="btn neutral" title="æ–™ç†ã‚’ãƒ©ãƒ³ãƒ€ãƒ ã«é¸ã¶">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ</button>
    </div>
          </div>
          <div class="row" style="margin-top:12px;">
            <button id="createOrderBtn" class="btn primary">æ³¨æ–‡ã‚’å…¨ãƒãƒ¼ãƒ ã«å‡ºã™</button>
            <div id="createMsg" class="msg" role="status" aria-live="polite"></div>
          </div>
        
        </div>

        <!-- å³ï¼šã‚»ãƒƒã‚·ãƒ§ãƒ³ -->
        <div class="panel">
          <h3>ã‚»ãƒƒã‚·ãƒ§ãƒ³</h3>
          <div class="row"><div class="muted">çŠ¶æ…‹ï¼š</div><div id="sessState">â€”</div></div>
          <div class="row"><div class="muted">æœ‰åŠ¹æœŸé™ï¼š</div><div id="sessExp">â€”</div></div>
          <div class="row" style="margin-top:8px;">
            <button id="logoutBtn" class="btn warn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
            <button id="backBtn" class="btn neutral">æˆ»ã‚‹</button>
          </div>
        </div>
      </div>
<!-- â˜…è¿½åŠ ï¼šã‚²ãƒ¼ãƒ å…¨ãƒªã‚»ãƒƒãƒˆ -->
<div class="row" style="margin-top:10px;">
  <button id="resetBtn" class="btn warn">ã‚²ãƒ¼ãƒ å…¨ãƒªã‚»ãƒƒãƒˆ</button>
  <div id="resetMsg" class="msg" role="status" aria-live="polite"></div>
</div>

      <!-- ä¸€æ‹¬æ“ä½œ -->
      <div class="panel" style="margin-top:14px;">
        <h3>ä¸€æ‹¬æ“ä½œ</h3>
        <div class="row">
          <button id="clearAllBtn" class="btn warn">æ³¨æ–‡å¸³æ¶ˆã—ï¼ˆå…¨ãƒãƒ¼ãƒ ï¼‰</button>
          <div id="bulkMsg" class="msg" role="status" aria-live="polite"></div>
        </div>
        <div class="panel" style="margin-top:14px;">
  <h3>ã‚°ãƒ­ãƒ¼ãƒãƒ«ä¸€æ™‚åœæ­¢</h3>
  <div class="row">
    <button id="pauseBtn" class="btn warn">å…¨ãƒšãƒ¼ã‚¸ã‚’ä¸€æ™‚åœæ­¢</button>
    <button id="resumeBtn" class="btn primary">ä¸€æ™‚åœæ­¢ã‚’è§£é™¤</button>
  </div>
  <div class="help">â€» é‡£ã‚Š/ç‹©ã‚Š/æ¡å–/æ³¨æ–‡ãªã©ã€å…¨ã¦ã®ãƒ—ãƒ¬ã‚¤ç”»é¢ãŒæ“ä½œä¸å¯ã«ãªã‚Šã¾ã™ã€‚</div>
  <div id="pauseStateMsg" class="msg"></div>
</div>

      </div>

      <!-- æ³¨æ–‡ä¸€è¦§ï¼ˆãƒãƒ¼ãƒ åˆ¥è¡¨ç¤ºï¼‰ -->
      <div class="panel" style="margin-top:16px;">
        <h3>æ³¨æ–‡ä¸€è¦§ï¼ˆãƒãƒ¼ãƒ åˆ¥ï¼‰</h3>
        <div class="thead">
          <div>ãƒãƒ¼ãƒ </div><div>ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆæ–™ç†å / ç´ æï¼‰</div><div>ä½œæˆ</div><div>æ“ä½œ</div>
        </div>
        <div id="ordersList" class="list"></div>
        <div id="listMsg" class="msg muted"></div>
      </div>
      <!-- ãƒãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆ -->
<div class="panel" style="margin-top:14px;">
  <h3>ãƒãƒ¼ãƒ ãƒã‚¤ãƒ³ãƒˆ</h3>
  <div id="pointsList" class="row" style="gap:16px; flex-wrap:wrap;"></div>
</div>

    </section>

  </main>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
   import {
  getDatabase, ref, child, get, push, onValue, remove, set
} from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";


    // ======== â˜…ã“ã“ã‚’ç·¨é›†ï¼šæ–™ç†å â†’ ç´ æé…åˆ—ï¼ˆç¨®é¡ã¯å»ƒæ­¢ï¼‰ ========
    const DISH_MASTER = {

  "ãƒ‰ãƒ©ã‚´ãƒ³ã‚¹ãƒ†ãƒ¼ã‚­": { "materials": ["ãƒ‰ãƒ©ã‚´ãƒ³ãƒŸãƒ¼ãƒˆ","ãƒ•ã‚¡ã‚¤ã‚¢ãƒšãƒƒãƒ‘ãƒ¼","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹"] },
  "ãƒ‰ãƒ©ã‚´ãƒ³ã‚¨ãƒƒã‚°ã‚ªãƒ ãƒ¬ãƒ„": { "materials": ["ãƒ‰ãƒ©ã‚´ãƒ³ã‚¨ãƒƒã‚°","ã‚µãƒ³ãƒªãƒ¼ãƒ•","ã‚´ãƒ¼ãƒ«ãƒ‰ã‚°ãƒ¬ã‚¤ãƒ³"] },
  "é¦™è‰ç„¼ãã‚¹ãƒˆãƒ¼ãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥": { "materials": ["ã‚¹ãƒˆãƒ¼ãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ãƒŸã‚¹ãƒˆãƒªãƒ¼ãƒ•","ãƒšãƒƒãƒ‘ãƒ¼ã‚·ãƒ¼ãƒ‰"] },
  "ãƒ ãƒ¼ãƒ³ãƒ™ãƒªãƒ¼ã‚½ãƒ¼ã‚¹ã®ã‚¯ãƒªã‚¹ã‚¿ãƒ«ã‚«ãƒ¼ãƒ—": { "materials": ["ã‚¯ãƒªã‚¹ã‚¿ãƒ«ã‚«ãƒ¼ãƒ—","ãƒ ãƒ¼ãƒ³ãƒ™ãƒªãƒ¼","ãƒŠã‚¤ãƒˆãƒãƒ‹ãƒ¼"] },
  "ã‚¹ãƒ‘ã‚¤ã‚·ãƒ¼ãƒ•ãƒ­ã‚¹ãƒˆãƒˆãƒ©ã‚¦ãƒˆã‚¹ãƒ¼ãƒ—": { "materials": ["ãƒ•ãƒ­ã‚¹ãƒˆãƒˆãƒ©ã‚¦ãƒˆ","ãƒ•ã‚¡ã‚¤ã‚¢ãƒšãƒƒãƒ‘ãƒ¼","ã‚µãƒ³ãƒªãƒ¼ãƒ•"] },
  "ã‚·ãƒ£ãƒ‰ã‚¦ãƒ•ãƒ«ãƒ¼ãƒ„é‹ãƒ«ãƒŸãƒŠã‚¹ãƒ•ã‚£ãƒƒã‚·ãƒ¥": { "materials": ["ãƒ«ãƒŸãƒŠã‚¹ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ã‚·ãƒ£ãƒ‰ã‚¦ãƒ•ãƒ«ãƒ¼ãƒ„","ã‚°ãƒ­ã‚¦ã‚¸ã‚§ãƒ«"] },
  "ã‚ªãƒ¼ãƒ­ãƒ©ãƒ•ã‚£ãƒƒã‚·ãƒ¥å¯¿å¸": { "materials": ["ã‚ªãƒ¼ãƒ­ãƒ©ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹","ãƒŸã‚¹ãƒˆãƒ‰ãƒ­ãƒƒãƒ—"] },
  "ã‚¢ãƒ“ã‚¹ãƒ‰ãƒ©ã‚´ãƒ³ã®è±ªè¯é‹": { "materials": ["ãƒ‰ãƒ©ã‚´ãƒ³ãƒŸãƒ¼ãƒˆ","ãƒ‰ãƒ©ã‚´ãƒ³ã‚¨ãƒƒã‚°","ã‚¯ãƒªã‚¹ã‚¿ãƒ«ãƒ•ãƒ«ãƒ¼ãƒ„"] },
  "ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã®é¦™è‰ç„¼ã": { "materials": ["ã‚¹ãƒ¢ãƒ¼ã‚¯ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ã‚µãƒ³ãƒªãƒ¼ãƒ•","ãƒ“ãƒ¼ãƒˆãƒ«ãƒŠãƒƒãƒ„"] },
  "ãƒ¢ã‚¹ã‚«ãƒ¼ãƒ—ã®ãƒãƒ¼ãƒ–ãƒ•ãƒ©ã‚¤": { "materials": ["ãƒ¢ã‚¹ã‚«ãƒ¼ãƒ—","ã‚µãƒ³ãƒªãƒ¼ãƒ•","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹"] },
  "ã‚·ãƒ£ãƒ‰ã‚¦ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã®ç”˜éœ²ç…®": { "materials": ["ã‚·ãƒ£ãƒ‰ã‚¦ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ãƒŠã‚¤ãƒˆãƒãƒ‹ãƒ¼","ã‚µãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼"] },
  "ã‚µãƒ³ãƒ€ãƒ¼ãƒ‹ãƒ¼ãƒ‰ãƒ«ã®å”æšã’": { "materials": ["ã‚µãƒ³ãƒ€ãƒ¼ãƒ‹ãƒ¼ãƒ‰ãƒ«","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹","ãƒ•ã‚¡ã‚¤ã‚¢ãƒšãƒƒãƒ‘ãƒ¼"] },
  "ãƒ–ãƒ©ãƒƒãƒ‰ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã®èµ¤ãƒ¯ã‚¤ãƒ³é¢¨ç…®è¾¼ã¿": { "materials": ["ãƒ–ãƒ©ãƒƒãƒ‰ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ãƒ™ãƒªãƒ¼ã‚¸ãƒ¥ãƒ¼ã‚¹","ãƒ ãƒ¼ãƒ³ãƒ‘ã‚¦ãƒ€ãƒ¼"] },
  "ãƒ†ãƒ³ãƒšã‚¹ãƒˆã‚¤ãƒ¼ãƒ«ã®å‘³å™Œé¢¨ç…®è¾¼ã¿": { "materials": ["ãƒ†ãƒ³ãƒšã‚¹ãƒˆã‚¤ãƒ¼ãƒ«","ãƒŸã‚¹ãƒˆãƒªãƒ¼ãƒ•","ã‚°ãƒ­ã‚¦ã‚¸ã‚§ãƒ«"] },
  "ãƒ•ãƒ¬ã‚¤ãƒ ã‚µãƒ¼ãƒ¢ãƒ³ã®ãƒã‚¿ãƒ¼ç„¼ã": { "materials": ["ãƒ•ãƒ¬ã‚¤ãƒ ã‚µãƒ¼ãƒ¢ãƒ³","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹","ã‚µãƒ³ãƒªãƒ¼ãƒ•"] },
  "ã‚¹ã‚«ã‚¤ãƒ¬ã‚¤ã®ã‚«ãƒ«ãƒ‘ãƒƒãƒãƒ§": { "materials": ["ã‚¹ã‚«ã‚¤ãƒ¬ã‚¤","ã‚¯ãƒªã‚¹ã‚¿ãƒ«ã‚³ã‚¢","ãƒŸã‚¹ãƒˆãƒ‰ãƒ­ãƒƒãƒ—"] },
  "ã‚¢ãƒ“ã‚¹ãƒ‰ãƒ©ã‚´ãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã®ç…®ä»˜ã‘": { "materials": ["ã‚¢ãƒ“ã‚¹ãƒ‰ãƒ©ã‚´ãƒ³ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ã‚¹ãƒ”ãƒªãƒƒãƒˆã‚¨ã‚­ã‚¹","ãƒ ãƒ¼ãƒ³ãƒ‘ã‚¦ãƒ€ãƒ¼"] },
  "ãƒŸãƒ©ãƒ¼ã‚¸ãƒ¥ã‚·ãƒ£ãƒ¼ã‚¯ã®ã‚°ãƒªãƒ«": { "materials": ["ãƒŸãƒ©ãƒ¼ã‚¸ãƒ¥ã‚·ãƒ£ãƒ¼ã‚¯","ãƒšãƒƒãƒ‘ãƒ¼ã‚·ãƒ¼ãƒ‰","ãƒ“ãƒ¼ãƒˆãƒ«ãƒãƒ‹ãƒ¼"] },

  "ç«œåµãƒãƒ£ãƒ¼ãƒãƒ³": { "materials": ["ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹","ãƒ‰ãƒ©ã‚´ãƒ³ã‚¨ãƒƒã‚°","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹"] },
  "ã‚´ãƒ¼ãƒ«ãƒ‰ã‚°ãƒ¬ã‚¤ãƒ³ãƒ‘ãƒ³": { "materials": ["ã‚´ãƒ¼ãƒ«ãƒ‰ã‚°ãƒ¬ã‚¤ãƒ³","ã‚°ãƒ¬ã‚¤ãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ“ãƒ¼ãƒˆãƒ«ãƒãƒ‹ãƒ¼"] },
  "ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹ãŠã«ãã‚Š": { "materials": ["ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹","ãƒŸã‚¹ãƒˆãƒªãƒ¼ãƒ•","ãƒŠã‚¤ãƒˆãƒãƒ‹ãƒ¼"] },
  "ã‚¯ãƒªã‚¹ã‚¿ãƒ«ãƒ•ãƒ«ãƒ¼ãƒ„ãƒ‘ã‚¤": { "materials": ["ã‚°ãƒ¬ã‚¤ãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ã‚¯ãƒªã‚¹ã‚¿ãƒ«ãƒ•ãƒ«ãƒ¼ãƒ„","ãƒ“ãƒ¼ãƒˆãƒ«ãƒŠãƒƒãƒ„"] },
  "ãƒ©ã‚¤ã‚¹ãƒŒã‚«æ¼¬ã‘": { "materials": ["ãƒ©ã‚¤ã‚¹ãƒŒã‚«","ã‚µãƒ³ãƒªãƒ¼ãƒ•","ãƒŸã‚¹ãƒˆãƒ‰ãƒ­ãƒƒãƒ—"] },
  "ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹ã‚¯ãƒ©ãƒƒã‚«ãƒ¼": { "materials": ["ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹","ã‚°ãƒ¬ã‚¤ãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ“ãƒ¼ãƒˆãƒ«ãƒŠãƒƒãƒ„"] },

  "ãƒ•ãƒ¬ã‚¤ãƒ ãƒšãƒƒãƒ‘ãƒ¼ã‚µãƒ©ãƒ€": { "materials": ["ãƒ•ã‚¡ã‚¤ã‚¢ãƒšãƒƒãƒ‘ãƒ¼","ã‚µãƒ³ãƒªãƒ¼ãƒ•","ã‚·ãƒ£ãƒ‰ã‚¦ãƒ•ãƒ«ãƒ¼ãƒ„"] },
  "ã‚µãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼ã‚¹ãƒ¼ãƒ—": { "materials": ["ã‚µãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ ãƒ¼ãƒ³ãƒ‘ã‚¦ãƒ€ãƒ¼","ã‚°ãƒ­ã‚¦ã‚¸ã‚§ãƒ«"] },
  "ã‚¯ãƒªã‚¹ã‚¿ãƒ«ã‚³ã‚¢é£´": { "materials": ["ã‚¯ãƒªã‚¹ã‚¿ãƒ«ã‚³ã‚¢","ãƒ“ãƒ¼ãƒˆãƒ«ãƒãƒ‹ãƒ¼"] },
  "ãƒ“ãƒ¼ãƒˆãƒ«ãƒŠãƒƒãƒ„ãƒ­ãƒ¼ã‚¹ãƒˆ": { "materials": ["ãƒ“ãƒ¼ãƒˆãƒ«ãƒŠãƒƒãƒ„","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹"] },
  "ã‚°ãƒ­ã‚¦ã‚¸ã‚§ãƒ«ã®ç…®å‡ã‚Š": { "materials": ["ã‚°ãƒ­ã‚¦ã‚¸ã‚§ãƒ«","ã‚¹ãƒ”ãƒªãƒƒãƒˆã‚¨ã‚­ã‚¹"] },
  "ã‚µãƒ³ãƒªãƒ¼ãƒ•ã®é¦™è‰ç‚’ã‚": { "materials": ["ã‚µãƒ³ãƒªãƒ¼ãƒ•","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹"] },

  "ãƒ ãƒ¼ãƒ³ãƒ™ãƒªãƒ¼ãƒ‘ã‚¤": { "materials": ["ãƒ ãƒ¼ãƒ³ãƒ™ãƒªãƒ¼","ã‚°ãƒ¬ã‚¤ãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ“ãƒ¼ãƒˆãƒ«ãƒãƒ‹ãƒ¼"] },
  "ãƒŠã‚¤ãƒˆãƒãƒ‹ãƒ¼ãƒ—ãƒªãƒ³": { "materials": ["ãƒŠã‚¤ãƒˆãƒãƒ‹ãƒ¼","ãƒ ãƒ¼ãƒ³ãƒ‘ã‚¦ãƒ€ãƒ¼","ãƒ‰ãƒ©ã‚´ãƒ³ã‚¨ãƒƒã‚°"] },
  "ãƒ“ãƒ¼ãƒˆãƒ«ãƒãƒ‹ãƒ¼ã‚¯ãƒƒã‚­ãƒ¼": { "materials": ["ã‚°ãƒ¬ã‚¤ãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ“ãƒ¼ãƒˆãƒ«ãƒãƒ‹ãƒ¼","ãƒŸã‚¹ãƒˆãƒªãƒ¼ãƒ•"] },
  "ã‚¯ãƒªã‚¹ã‚¿ãƒ«ãƒ•ãƒ«ãƒ¼ãƒ„ã‚¼ãƒªãƒ¼": { "materials": ["ã‚¯ãƒªã‚¹ã‚¿ãƒ«ãƒ•ãƒ«ãƒ¼ãƒ„","ã‚°ãƒ­ã‚¦ã‚¸ã‚§ãƒ«","ãƒ ãƒ¼ãƒ³ãƒ‘ã‚¦ãƒ€ãƒ¼"] },
  "ãƒ ãƒ¼ãƒ³ã‚¹ãƒ”ãƒªãƒƒãƒˆã‚±ãƒ¼ã‚­": { "materials": ["ã‚¹ãƒ”ãƒªãƒƒãƒˆã‚¨ã‚­ã‚¹","ãƒ ãƒ¼ãƒ³ãƒ‘ã‚¦ãƒ€ãƒ¼","ã‚´ãƒ¼ãƒ«ãƒ‰ã‚°ãƒ¬ã‚¤ãƒ³"] },
  "ã‚·ãƒ£ãƒ‰ã‚¦ãƒ•ãƒ«ãƒ¼ãƒ„ã‚¿ãƒ«ãƒˆ": { "materials": ["ã‚·ãƒ£ãƒ‰ã‚¦ãƒ•ãƒ«ãƒ¼ãƒ„","ã‚°ãƒ¬ã‚¤ãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ“ãƒ¼ãƒˆãƒ«ãƒŠãƒƒãƒ„"] },
  "ã‚¹ãƒ”ãƒªãƒƒãƒˆãƒ‰ãƒªãƒ³ã‚¯": { "materials": ["ã‚¹ãƒ”ãƒªãƒƒãƒˆã‚¨ã‚­ã‚¹","ãƒŸã‚¹ãƒˆãƒ‰ãƒ­ãƒƒãƒ—","ãƒŠã‚¤ãƒˆãƒãƒ‹ãƒ¼"] },
  "ãƒ©ã‚¤ãƒˆãƒ€ã‚¹ãƒˆã‚­ãƒ£ãƒ³ãƒ‡ã‚£": { "materials": ["ãƒ©ã‚¤ãƒˆãƒ€ã‚¹ãƒˆ","ãƒ“ãƒ¼ãƒˆãƒ«ãƒãƒ‹ãƒ¼"] },
  "ãƒ‰ãƒ©ã‚´ãƒ³ã‚¨ãƒƒã‚°ã‚·ãƒ•ã‚©ãƒ³": { "materials": ["ãƒ‰ãƒ©ã‚´ãƒ³ã‚¨ãƒƒã‚°","ã‚°ãƒ¬ã‚¤ãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ãƒ ãƒ¼ãƒ³ãƒ‘ã‚¦ãƒ€ãƒ¼"] },
  "ã‚ªãƒ¼ãƒ­ãƒ©ãƒ•ã‚£ãƒƒã‚·ãƒ¥ã®å†·è£½ãƒãƒªãƒ": { "materials": ["ã‚ªãƒ¼ãƒ­ãƒ©ãƒ•ã‚£ãƒƒã‚·ãƒ¥","ã‚µãƒ³ãƒ•ãƒ©ãƒ¯ãƒ¼","ã‚¹ãƒ”ãƒªãƒƒãƒˆã‚¨ã‚­ã‚¹"] },

  "ãƒ€ã‚¤ã‚ªã‚¦ã‚¤ã‚«ã®å¢¨ç…®": { "materials": ["ãƒ€ã‚¤ã‚ªã‚¦ã‚¤ã‚«","ãƒŸã‚¹ãƒˆãƒªãƒ¼ãƒ•","ã‚¹ãƒ”ãƒªãƒƒãƒˆã‚¨ã‚­ã‚¹"] },
  "ãƒ€ã‚¤ã‚ªã‚¦ã‚¤ã‚«ã®å”æšã’": { "materials": ["ãƒ€ã‚¤ã‚ªã‚¦ã‚¤ã‚«","ãƒ•ãƒ¬ã‚¤ãƒ ã‚°ãƒªãƒ¼ã‚¹","ãƒ•ã‚¡ã‚¤ã‚¢ãƒšãƒƒãƒ‘ãƒ¼"] },
  "ãƒ€ã‚¤ã‚ªã‚¦ã‚¤ã‚«ã¨ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹ã®ç‚Šãè¾¼ã¿ã”é£¯": { "materials": ["ãƒ€ã‚¤ã‚ªã‚¦ã‚¤ã‚«","ã‚¹ã‚¿ãƒ¼ãƒ©ã‚¤ã‚¹","ã‚µãƒ³ãƒªãƒ¼ãƒ•"] }


    };
    // ===============================================================

    const firebaseConfig = {
      apiKey: "AIzaSyDPe5cSCavq5gHopugdOfQ-9_50cTrqmyk",
      authDomain: "school-178c2.firebaseapp.com",
      databaseURL: "https://school-178c2-default-rtdb.europe-west1.firebasedatabase.app",
      projectId: "school-178c2",
      storageBucket: "school-178c2.firebasestorage.app",
      messagingSenderId: "409885673101",
      appId: "1:409885673101:web:25bf0483547e2d470304c4"
    };

    const app = initializeApp(firebaseConfig);
    const db  = getDatabase(app);

    // ===== DOM =====
    const loginCard = document.getElementById('loginCard');
    const dashCard  = document.getElementById('dashCard');
    const pwInput   = document.getElementById('pw');
    const loginBtn  = document.getElementById('loginBtn');
    const loginMsg  = document.getElementById('loginMsg');
    const togglePw  = document.getElementById('togglePw');

    const dishSelect    = document.getElementById('dishSelect');
    const dishPreview   = document.getElementById('dishPreview');
    const randomDishBtn  = document.getElementById('randomDishBtn'); // â† è¿½åŠ 
    const createOrderBtn= document.getElementById('createOrderBtn');
    const createMsg     = document.getElementById('createMsg');

    const clearAllBtn   = document.getElementById('clearAllBtn');
    const bulkMsg       = document.getElementById('bulkMsg');
const resetBtn = document.getElementById('resetBtn'); // â˜…è¿½åŠ 
const resetMsg = document.getElementById('resetMsg'); // â˜…è¿½åŠ 

    const sessState = document.getElementById('sessState');
    const sessExp   = document.getElementById('sessExp');
    const logoutBtn = document.getElementById('logoutBtn');
    const backBtn   = document.getElementById('backBtn');

    const ordersList = document.getElementById('ordersList');
    const listMsg    = document.getElementById('listMsg');

    // ===== ã‚»ãƒƒã‚·ãƒ§ãƒ³ =====
    const SS_KEY = 'owner_session_v1';
    const SESSION_MS = 2 * 60 * 60 * 1000;
    const now = ()=> Date.now();
    const fmt = (ts)=>{ try{ const d=new Date(ts); return `${d.getFullYear()}/${String(d.getMonth()+1).padStart(2,'0')}/${String(d.getDate()).padStart(2,'0')} ${String(d.getHours()).padStart(2,'0')}:${String(d.getMinutes()).padStart(2,'0')}` }catch{ return 'â€”' } };
    const loadSess = ()=>{ try{ const raw = sessionStorage.getItem(SS_KEY); return raw?JSON.parse(raw):null }catch{ return null } };
    const saveSess = (o)=>{ try{ sessionStorage.setItem(SS_KEY, JSON.stringify(o)) }catch{} };
    const clearSess= ()=>{ try{ sessionStorage.removeItem(SS_KEY) }catch{} };
    const updateSessUI = (s)=>{ if(s&&s.ok){ sessState.textContent='ãƒ­ã‚°ã‚¤ãƒ³ä¸­'; sessExp.textContent=fmt(s.exp) } else { sessState.textContent='æœªãƒ­ã‚°ã‚¤ãƒ³'; sessExp.textContent='â€”' } };
    const showDash = ()=>{ loginCard.classList.add('hidden'); dashCard.classList.remove('hidden'); };
    const showLogin= ()=>{ dashCard.classList.add('hidden'); loginCard.classList.remove('hidden'); };
    const pauseBtn = document.getElementById('pauseBtn');
const resumeBtn = document.getElementById('resumeBtn');
const pauseStateMsg = document.getElementById('pauseStateMsg');
    // â˜…è¿½åŠ ï¼šã‚²ãƒ¼ãƒ å…¨ãƒªã‚»ãƒƒãƒˆï¼ˆWAREHOUSE / gameâ†’points / logsï¼‰
resetBtn.addEventListener('click', async ()=>{
  resetMsg.textContent = '';
  const s = loadSess();
  if (!(s && s.ok && s.exp > now())){ 
    resetMsg.textContent='ãƒ­ã‚°ã‚¤ãƒ³æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ã¾ã™ã€‚'; 
    resetMsg.className='msg warn'; 
    return; 
  }

  if (!confirm('æœ¬å½“ã«ã‚²ãƒ¼ãƒ å…¨ãƒªã‚»ãƒƒãƒˆã‚’å®Ÿè¡Œã—ã¾ã™ã‹ï¼Ÿ')) return;

  try{
    await Promise.all([
      remove(ref(db, 'warehouse')),
      remove(ref(db, 'game/points')),
      remove(ref(db, 'game/orders'))

    ]);
    resetMsg.textContent = 'ãƒªã‚»ãƒƒãƒˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚';
    resetMsg.className = 'msg ok';
  }catch(e){
    console.error(e);
    resetMsg.textContent = 'ãƒªã‚»ãƒƒãƒˆã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆæ¨©é™/ãƒ«ãƒ¼ãƒ«ã‚’ç¢ºèªï¼‰ã€‚';
    resetMsg.className = 'msg err';
  }
});

// ãƒ©ãƒ³ãƒ€ãƒ é¸æŠãƒœã‚¿ãƒ³
randomDishBtn.addEventListener('click', () => {
  const names = Object.keys(DISH_MASTER);
  if (!names.length) {
    alert('é¸æŠã§ãã‚‹æ–™ç†ãŒã‚ã‚Šã¾ã›ã‚“ï¼ˆDISH_MASTERãŒç©ºã§ã™ï¼‰ã€‚');
    return;
  }
  const r = names[Math.floor(Math.random() * names.length)];
  dishSelect.value = r;
  updateDishPreview();
});

function controlRef(){ return ref(db, 'game/control/state'); }

// çŠ¶æ…‹ã‚’ç›£è¦–ï¼ˆUIã«ç¾åœ¨ã®ä¸€æ™‚åœæ­¢çŠ¶æ³ã‚’å‡ºã™ï¼‰
onValue(controlRef(), (snap)=>{
  const s = snap.exists()? snap.val(): null;
  const paused = !!(s && s.paused);
  pauseStateMsg.textContent = paused ? `ä¸€æ™‚åœæ­¢ä¸­ï¼š${s?.message||''}`.trim() : 'ç¨¼åƒä¸­';
  pauseStateMsg.className = 'msg ' + (paused ? 'warn' : 'ok');
});

// æŠ¼ä¸‹ã§ON
pauseBtn.addEventListener('click', async ()=>{
  const s = loadSess();
  if (!(s && s.ok && s.exp > now())){ alert('ãƒ­ã‚°ã‚¤ãƒ³æœŸé™åˆ‡ã‚Œ'); return; }
  const msg = prompt('ä¸€æ™‚åœæ­¢ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆä»»æ„ï¼‰', 'ã‚ªãƒ¼ãƒŠãƒ¼ãŒä¸€æ™‚åœæ­¢ã—ã¾ã—ãŸ');
  try{
    await set(controlRef(), { paused:true, message: String(msg||''), updatedAt: Date.now() });
    alert('å…¨ãƒšãƒ¼ã‚¸ã‚’ä¸€æ™‚åœæ­¢ã«ã—ã¾ã—ãŸ');
  }catch(e){ console.error(e); alert('è¨­å®šã«å¤±æ•—ã—ã¾ã—ãŸ'); }
});

// æŠ¼ä¸‹ã§OFF
resumeBtn.addEventListener('click', async ()=>{
  const s = loadSess();
  if (!(s && s.ok && s.exp > now())){ alert('ãƒ­ã‚°ã‚¤ãƒ³æœŸé™åˆ‡ã‚Œ'); return; }
  try{
    await set(controlRef(), { paused:false, message:'', updatedAt: Date.now() });
    alert('ä¸€æ™‚åœæ­¢ã‚’è§£é™¤ã—ã¾ã—ãŸ');
  }catch(e){ console.error(e); alert('è§£é™¤ã«å¤±æ•—ã—ã¾ã—ãŸ'); }
});

    // èµ·å‹•ï¼šæ–™ç†ãƒªã‚¹ãƒˆâ†’ã‚»ãƒƒã‚·ãƒ§ãƒ³ç¢ºèªâ†’è³¼èª­é–‹å§‹
    (function boot(){
      // æ–™ç†ãƒ—ãƒ«ãƒ€ã‚¦ãƒ³æç”»
      const names = Object.keys(DISH_MASTER).sort((a,b)=> a.localeCompare(b,'ja'));
      dishSelect.innerHTML = '';
      names.forEach(n=>{
        const opt = document.createElement('option');
        opt.value = n; opt.textContent = n; dishSelect.appendChild(opt);
      });
      if (names.length === 0){
        const opt = document.createElement('option');
        opt.value = ''; opt.textContent = 'ï¼ˆDISH_MASTERã«æ–™ç†ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ï¼‰';
        dishSelect.appendChild(opt);
      }
      updateDishPreview();

      const s = loadSess();
      if (s && s.ok && s.exp > now()){ updateSessUI(s); showDash(); }
      else { clearSess(); showLogin(); }

      // æ³¨æ–‡è³¼èª­ï¼ˆãƒãƒ¼ãƒ åˆ¥ï¼‰
// æ—¢å­˜ï¼šæ³¨æ–‡ã®è³¼èª­
onValue(ref(db, 'game/orders'), (snap)=>{
  const val = snap.exists()? snap.val() : null;
  renderOrders(val);
});

// â˜…è¿½åŠ ï¼šãƒã‚¤ãƒ³ãƒˆã®è³¼èª­
onValue(ref(db, 'game/points'), (snap)=>{
  const val = snap.exists()? snap.val() : {};
  renderPoints(val);
});

      
    })();

    function updateDishPreview(){
      const key = dishSelect.value;
      const def = DISH_MASTER[key];
      if (!def){ dishPreview.textContent = 'â€”'; return; }
      dishPreview.textContent = `ç´ æï¼š${(def.materials||[]).join('ã€') || 'â€”'}`;
    }
    dishSelect.addEventListener('change', updateDishPreview);

    // ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¡¨ç¤ºåˆ‡æ›¿
    togglePw.addEventListener('click', ()=>{
      const visible = pwInput.type === 'text';
      pwInput.type = visible ? 'password' : 'text';
      togglePw.setAttribute('aria-pressed', String(!visible));
    });

    // Enterã§ãƒ­ã‚°ã‚¤ãƒ³
    pwInput.addEventListener('keydown', (e)=>{ if (e.key === 'Enter') loginBtn.click(); });

    // ãƒ­ã‚°ã‚¤ãƒ³
    loginBtn.addEventListener('click', async ()=>{
      loginMsg.textContent = '';
      const input = pwInput.value || '';
      if (!input){ loginMsg.textContent='ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚'; loginMsg.className='msg err'; return; }
      try{
        const snap = await get(child(ref(db), 'game/ownerPassword'));
        if (!snap.exists()){ loginMsg.textContent='ownerPassword ãŒæœªè¨­å®šã§ã™ã€‚'; loginMsg.className='msg warn'; return; }
        const correct = String(snap.val() ?? '');
        if (input === correct){
          const s = { ok:true, exp: now() + SESSION_MS };
          saveSess(s); updateSessUI(s); showDash(); pwInput.value=''; loginMsg.textContent='';
        }else{
          loginMsg.textContent='ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™ã€‚'; loginMsg.className='msg err';
        }
      }catch(e){
        console.error(e); loginMsg.textContent='é€šä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸã€‚'; loginMsg.className='msg err';
      }
    });

    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ / æˆ»ã‚‹
    logoutBtn.addEventListener('click', ()=>{ clearSess(); updateSessUI(null); showLogin(); });
    backBtn.addEventListener('click', ()=>{ if (document.referrer) history.back(); else location.href='menu.html'; });

    // æ³¨æ–‡ä½œæˆï¼ˆå…¨ãƒãƒ¼ãƒ ã¸åŒå ±ï¼‰
    createOrderBtn.addEventListener('click', async ()=>{
      createMsg.textContent = '';
      const s = loadSess();
      if (!(s && s.ok && s.exp > now())){ createMsg.textContent='ãƒ­ã‚°ã‚¤ãƒ³æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ã¾ã™ã€‚'; createMsg.className='msg warn'; return; }

      const dish = dishSelect.value;
      const def  = DISH_MASTER[dish];
      if (!def){ createMsg.textContent='DISH_MASTERã«å­˜åœ¨ã—ãªã„æ–™ç†ã§ã™ã€‚'; createMsg.className='msg err'; return; }

      const payload = {
        status: { dish, materials: Array.isArray(def.materials)? def.materials : [] },
        createdAt: now(),
        updatedAt: now()
      };

      try{
        const teams = ['team1','team2','team3','team4'];
        await Promise.all(teams.map(t => push(ref(db, `game/orders/${t}`), payload)));
        createMsg.textContent='4ãƒãƒ¼ãƒ ã«æ³¨æ–‡ã‚’å‡ºã—ã¾ã—ãŸã€‚'; createMsg.className='msg ok';
      }catch(e){
        console.error(e); createMsg.textContent='ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆæ¨©é™/ãƒ«ãƒ¼ãƒ«ã‚’ç¢ºèªï¼‰ã€‚'; createMsg.className='msg err';
      }
    });

    // æ³¨æ–‡å¸³æ¶ˆã—ï¼ˆå…¨ãƒãƒ¼ãƒ ï¼‰
    clearAllBtn.addEventListener('click', async ()=>{
      bulkMsg.textContent = '';
      const s = loadSess();
      if (!(s && s.ok && s.exp > now())){ bulkMsg.textContent='ãƒ­ã‚°ã‚¤ãƒ³æœ‰åŠ¹æœŸé™ãŒåˆ‡ã‚Œã¦ã„ã¾ã™ã€‚'; bulkMsg.className='msg warn'; return; }
      if (!confirm('æœ¬å½“ã«å…¨ãƒãƒ¼ãƒ ã®æ³¨æ–‡ã‚’å¸³æ¶ˆã—ï¼ˆå‰Šé™¤ï¼‰ã—ã¾ã™ã‹ï¼Ÿ')) return;
      try{
        await remove(ref(db, 'game/orders')); // è¦ªã‚’ä¸¸ã”ã¨æ¶ˆã™ â†’ team1..4 ã‚‚æ¶ˆãˆã‚‹
        bulkMsg.textContent = 'å…¨ãƒãƒ¼ãƒ ã®æ³¨æ–‡ã‚’å¸³æ¶ˆã—ã«ã—ã¾ã—ãŸã€‚'; bulkMsg.className='msg ok';
      }catch(e){
        console.error(e); bulkMsg.textContent='å¸³æ¶ˆã—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚'; bulkMsg.className='msg err';
      }
    });

    // æ³¨æ–‡ä¸€è¦§ï¼ˆãƒãƒ¼ãƒ åˆ¥ï¼‰
function renderOrders(root){
  ordersList.innerHTML = '';
  const teams = ['team1','team2','team3','team4'];
  let total = 0;

  teams.forEach(team=>{
    const map = root?.[team] || null;
    const entries = map ? Object.entries(map) : [];
    entries.sort((a,b)=> (b[1]?.createdAt||0) - (a[1]?.createdAt||0));

    entries.forEach(([id, o])=>{
      total++;
      const row = document.createElement('div'); row.className='trow';

      // åˆ—1ï¼šãƒãƒ¼ãƒ 
      const teamEl = document.createElement('div');
      teamEl.textContent = team.toUpperCase().replace('TEAM','ãƒãƒ¼ãƒ ');

      // ï¼ˆIDåˆ—ã¯ä½œã‚‰ãªã„ï¼‰

      // åˆ—2ï¼šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆæ–™ç†å / ç´ æï¼‰
      const statusEl = document.createElement('div');
      const dishSpan = document.createElement('div'); dishSpan.innerHTML = `<b>${o?.status?.dish || 'â€”'}</b>`;
      const matsSpan = document.createElement('div'); matsSpan.className='muted';
      matsSpan.textContent = (o?.status?.materials||[]).join('ã€') || 'â€”';
      statusEl.appendChild(dishSpan); statusEl.appendChild(matsSpan);

      // åˆ—3ï¼šä½œæˆ
      const timeEl = document.createElement('div'); timeEl.className='muted'; timeEl.textContent = fmt(o.createdAt);

      // åˆ—4ï¼šæ“ä½œ
      const actEl = document.createElement('div'); actEl.className='actions';
      const delBtn = document.createElement('button'); delBtn.className='btn warn'; delBtn.textContent='å‰Šé™¤';
      actEl.appendChild(delBtn);

      // 4åˆ—ã¶ã‚“ã ã‘ appendï¼ˆIDã¯æŒŸã¾ãªã„ï¼‰
      row.appendChild(teamEl);
      row.appendChild(statusEl);
      row.appendChild(timeEl);
      row.appendChild(actEl);
      ordersList.appendChild(row);

      // å€‹åˆ¥å‰Šé™¤ï¼ˆç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰IDè¡¨è¨˜ã‚’å¤–ã™ or æ™‚åˆ»ã«ã™ã‚‹ï¼‰
      delBtn.addEventListener('click', async ()=>{
        if (!confirm(`ã“ã®æ³¨æ–‡ï¼ˆ${team} / ${fmt(o.createdAt)}ï¼‰ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) return;
        try{ await remove(ref(db, `game/orders/${team}/${id}`)); }
        catch(e){ console.error(e); alert('å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸã€‚'); }
      });
    });
  });

  listMsg.textContent = total === 0 ? 'æ³¨æ–‡ã¯ã¾ã ã‚ã‚Šã¾ã›ã‚“ã€‚' : `åˆè¨ˆ ${total} ä»¶`;
}

    const pointsList = document.getElementById('pointsList');

function renderPoints(map){
  pointsList.innerHTML = '';
  ['team1','team2','team3','team4'].forEach(t=>{
    const v = map?.[t] ?? 0;
    const pill = document.createElement('div');
    pill.className = 'btn neutral';
    pill.style.cursor = 'default';
    pill.textContent = `${t.toUpperCase().replace('TEAM','ãƒãƒ¼ãƒ ')}ï¼š${v}`;
    pointsList.appendChild(pill);
  });
}

  </script>
</body>
</html>











