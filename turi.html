<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TURI – 改良版カースティクス</title>
<style>
  :root{
    --stage-w: min(1280px, 94vw);
    --ratio: 16/9;

    --water-opacity: .80;     /* 水層の不透明度 */
    --tint-color: #19b5c1;    /* 水色のティント */
    --tint-alpha: .22;        /* ティント濃度 */
    --caustics-alpha: .28;    /* 光の筋の濃度 */
    --wobble-scale: 8;        /* 水の歪み強さ */
    --wobble-speed: 12s;      /* 歪みの速さ */
  }

  *{ box-sizing: border-box }
  html,body{
    height:100%; margin:0;
    background:#05121a; color:#e7f7ff;
    font-family: system-ui,-apple-system,Segoe UI,Roboto, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
  }
  .wrap{
    min-height:100%;
    display:grid; place-items:center;
    padding:16px; gap:14px;
  }

  .stage{
    position:relative;
    width: var(--stage-w);
    aspect-ratio: var(--ratio);
    overflow:hidden;
    border-radius: 18px;
    background:#000;
    box-shadow: 0 18px 48px rgba(0,0,0,.45);
  }
  .layer{
    position:absolute; inset:0;
    width:100%; height:100%;
    object-fit: cover;
    display:block;
    pointer-events:none;
  }

  /* レイヤー順 */
  #sand{ z-index: 1; }
  #waterBase{ z-index: 2; opacity: var(--water-opacity); }
  .tint{ z-index: 3; mix-blend-mode: multiply; background: color-mix(in srgb, var(--tint-color) calc(var(--tint-alpha)*100%), transparent); }
  .caustics{ z-index: 4; opacity: var(--caustics-alpha); mix-blend-mode: screen; background:#000; }
  #fish{ display:none; } /* 今は使わない */
</style>
</head>
<body>
  <main class="wrap">
    <section class="stage">
      <!-- 背面：砂 -->
      <img id="sand" class="layer" src="assets/sand.png" alt="砂">
      <!-- 水のベース -->
      <img id="waterBase" class="layer" src="assets/water_background_80percent.png" alt="水">
      <!-- ティント -->
      <div class="layer tint" aria-hidden="true"></div>
      <!-- 改良版カースティクス -->
      <div class="layer caustics" aria-hidden="true"></div>
      <!-- 魚はまだ非表示 -->
      <img id="fish" class="layer" src="assets/fish.png" alt="魚影">
    </section>
  </main>

  <!-- SVGフィルタ：自然な水の光模様 -->
  <svg width="0" height="0">
    <filter id="causticsFilter">
      <!-- ノイズ生成 -->
      <feTurbulence type="fractalNoise" baseFrequency="0.02 0.08" numOctaves="3" seed="4" result="noise">
        <animate attributeName="seed" from="0" to="999" dur="20s" repeatCount="indefinite"/>
      </feTurbulence>
      <!-- コントラスト強調して光筋っぽく -->
      <feColorMatrix type="matrix" values="
        1 0 0 0 0
        0 1 0 0 0
        0 0 1 0 0
        0 0 0 25 -5" result="contrast"/>
      <!-- 少しぼかす -->
      <feGaussianBlur stdDeviation="0.5" />
    </filter>
  </svg>

  <style>
    /* フィルタを適用 */
    .caustics{ filter:url(#causticsFilter); }
  </style>
</body>
</html>
